CREATE DATABASE EMPLOYEE_MANAGEMENT;
USE EMPLOYEE_MANAGEMENT;
CREATE TABLE DEPARTMENTS (
    DEPARTMENT_ID INT PRIMARY KEY,
    DEPARTMENT_NAME VARCHAR(100) NOT NULL
);
INSERT INTO DEPARTMENTS (DEPARTMENT_ID, DEPARTMENT_NAME) VALUES
(1, 'HUMAN RESOURCES'),
(2, 'FINANCE'),
(3, 'ENGINEERING');

SELECT * FROM DEPARTMENTS;
CREATE TABLE EMPLOYEES (
    EMPLOYEE_ID INT PRIMARY KEY,
    FIRST_NAME VARCHAR(50) NOT NULL,
    LAST_NAME VARCHAR(50) NOT NULL,
    DEPARTMENT_ID INT,
    HIRE_DATE DATE NOT NULL,
    FOREIGN KEY (DEPARTMENT_ID) REFERENCES DEPARTMENTS(DEPARTMENT_ID)
);
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, DEPARTMENT_ID, HIRE_DATE) VALUES
(1, 'JOHN', 'DOE', 1, '2023-06-15'),
(2, 'JANE', 'SMITH', 2, '2022-08-01'),
(3, 'EMILY', 'JOHNSON', 3, '2023-01-20'),
(4, 'MICHAEL', 'BROWN', 1, '2023-02-25'),
(5, 'JESSICA', 'DAVIS', 2, '2023-05-10');
SELECT * FROM EMPLOYEES;
CREATE TABLE SALARIES (
    EMPLOYEE_ID INT,
    SALARY DECIMAL(10, 2) NOT NULL,
    FROM_DATE DATE NOT NULL,
    TO_DATE DATE NOT NULL,
    FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEES(EMPLOYEE_ID),
    PRIMARY KEY (EMPLOYEE_ID, FROM_DATE)
);
INSERT INTO SALARIES (EMPLOYEE_ID, SALARY, FROM_DATE, TO_DATE) VALUES
(1, 60000, '2023-06-15', '9999-01-01'),
(2, 80000, '2022-08-01', '9999-01-01'),
(3, 70000, '2023-01-20', '9999-01-01'),
(4, 75000, '2023-02-25', '9999-01-01'),
(5, 90000, '2023-05-10', '9999-01-01');

SELECT * FROM SALARIES;

-- WRITE A QUERY TO FIND ALL EMPLOYEES WHO HAVE BEEN HIRED IN THE LAST YEAR.
SELECT EMPLOYEE_ID, FIRST_NAME, LAST_NAME, HIRE_DATE
FROM EMPLOYEES
WHERE HIRE_DATE <= CURDATE() - INTERVAL 1 YEAR;

-- WRITE A QUERY TO CALCULATE THE TOTAL SALARY EXPENDITURE FOR EACH DEPARTMENT.
SELECT D.DEPARTMENT_ID, D.DEPARTMENT_NAME, SUM(S.SALARY) AS TOTAL_SALARY_EXPENDITURE
FROM EMPLOYEES E
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN SALARIES S ON E.EMPLOYEE_ID = S.EMPLOYEE_ID
WHERE S.TO_DATE = '9999-01-01'
GROUP BY D.DEPARTMENT_ID, D.DEPARTMENT_NAME;

-- WRITE A QUERY TO FIND THE TOP 5 HIGHEST-PAID EMPLOYEES ALONG WITH THEIR DEPARTMENT NAMES.
SELECT E.EMPLOYEE_ID, E.FIRST_NAME, E.LAST_NAME, D.DEPARTMENT_NAME, S.SALARY
FROM EMPLOYEES E
JOIN SALARIES S ON E.EMPLOYEE_ID = S.EMPLOYEE_ID
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
WHERE S.TO_DATE = '9999-01-01'
ORDER BY S.SALARY DESC
LIMIT 5;
